<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="utf-8">
    <title>Source: template-tags.php - 10up Distributor Developer Documentation</title>

    <script src="scripts/prettify/prettify.js"> </script>
    <script src="scripts/prettify/lang-css.js"> </script>
    <!--[if lt IE 9]>
      <script src="//html5shiv.googlecode.com/svn/trunk/html5.js"></script>
    <![endif]-->
    <link type="text/css" rel="stylesheet" href="styles/prettify-tomorrow.css">
    <link type="text/css" rel="stylesheet" href="styles/jsdoc-default.css">

	<link href="https://fonts.googleapis.com/css?family=IBM+Plex+Mono|IBM+Plex+Sans:300,400|Playfair+Display:900&display=swap" rel="stylesheet"> 
    <link type="text/css" rel="stylesheet" href="styles-10up.css">
</head>

<body>

<div id="main">

	
    <h1 class="page-title">Source: template-tags.php</h1>
	

    



    
    <section>
        <article>
            <pre class="prettyprint source linenums"><code>&lt;?php
/**
 * These functions are intended to be used within themes and plugins
 *
 * @package  distributor
 */

/**
 * Determine if post is unlinked
 *
 * @param  int $post_id Post ID.
 * @since  1.0
 * @return bool
 */
function distributor_is_unlinked( $post_id = null ) {
	if ( null === $post_id ) {
		global $post;

		$post_id = $post->ID;
	}

	$unlinked = get_post_meta( $post_id, 'dt_unlinked' );

	return (bool) $unlinked;
}

/**
 * Get original post link as a string.
 *
 * @param  int $post_id Leave null to use current post
 * @since  1.0
 * @return string|bool
 */
function distributor_get_original_post_link( $post_id = null ) {
	if ( null === $post_id ) {
		global $post;

		$post_id = $post->ID;
	}

	$original_blog_id   = get_post_meta( $post_id, 'dt_original_blog_id', true );
	$original_post_id   = get_post_meta( $post_id, 'dt_original_post_id', true );
	$original_site_name = get_post_meta( $post_id, 'dt_original_site_name', true );
	$original_post_url  = get_post_meta( $post_id, 'dt_original_post_url', true );

	if ( ! empty( $original_blog_id ) &amp;&amp; ! empty( $original_post_id ) &amp;&amp; is_multisite() ) {
		switch_to_blog( $original_blog_id );

		$link = get_permalink( $original_post_id );

		restore_current_blog();

		return $link;
	} elseif ( ! empty( $original_site_name ) &amp;&amp; ! empty( $original_post_url ) ) {
		return $original_post_url;
	} else {
		return false;
	}
}

/**
 * See docblock for distributor_get_original_post_link
 *
 * @param  int $post_id Post ID.
 * @since 1.0
 */
function distributor_the_original_post_link( $post_id = null ) {
	echo esc_url( distributor_get_original_post_link( $post_id ) );
}

/**
 * Get original site name
 *
 * @param  int $post_id Leave null to use current post
 * @since  1.0
 * @return string|bool
 */
function distributor_get_original_site_name( $post_id = null ) {
	if ( null === $post_id ) {
		global $post;

		$post_id = $post->ID;
	}

	$original_blog_id   = get_post_meta( $post_id, 'dt_original_blog_id', true );
	$original_site_name = get_post_meta( $post_id, 'dt_original_site_name', true );

	if ( ! empty( $original_blog_id ) &amp;&amp; is_multisite() ) {
		switch_to_blog( $original_blog_id );

		$text = get_bloginfo( 'name' );

		restore_current_blog();

		return $text;
	} elseif ( ! empty( $original_site_name ) ) {
		return $original_site_name;
	} else {
		return false;
	}
}

/**
 * See docblock for distributor_get_original_site_name
 *
 * @param  int $post_id Post ID.
 * @since 1.0
 */
function distributor_the_original_site_name( $post_id = null ) {
	echo esc_html( distributor_get_original_site_name( $post_id ) );
}

/**
 * Get original site link
 *
 * @param  int $post_id Leave null to use current post
 * @since  1.0
 * @return string|bool
 */
function distributor_get_original_site_url( $post_id = null ) {
	if ( null === $post_id ) {
		global $post;

		$post_id = $post->ID;
	}

	$original_blog_id  = get_post_meta( $post_id, 'dt_original_blog_id', true );
	$original_site_url = get_post_meta( $post_id, 'dt_original_site_url', true );

	if ( ! empty( $original_blog_id ) &amp;&amp; is_multisite() ) {
		switch_to_blog( $original_blog_id );

		$url = home_url();

		restore_current_blog();

		return $url;
	} elseif ( ! empty( $original_site_url ) ) {
		return $original_site_url;
	} else {
		return false;
	}
}

/**
 * See docblock for distributor_get_original_site_url
 *
 * @param  int $post_id Post ID.
 * @since 1.0
 */
function distributor_the_original_site_url( $post_id = null ) {
	echo esc_url( distributor_get_original_site_url( $post_id ) );
}

/**
 * Get pretty link for outputting original distributor site link
 *
 * @param  int $post_id Post ID.
 * @since  1.0
 * @return string
 */
function distributor_get_original_site_link( $post_id = null ) {
	$site_name = distributor_get_original_site_name( $post_id );
	$site_url  = distributor_get_original_site_url( $post_id );

	if ( empty( $site_name ) || empty( $site_url ) ) {
		return '';
	}

	/**
	 * Filter the original site link for a distributed post.
	 *
	 * @since 1.0.0
	 * @hook distributor_get_original_site_link
	 *
	 * @param {string} $link A formatted version of the original site link.
	 *
	 * @return {string} A formatted version of the original site link.
	 */
	/* translators: %1$s: site url, %2$s; site name*/
	return apply_filters( 'distributor_get_original_site_link', sprintf( __( 'By &lt;a href="%1$s">%2$s&lt;/a>', 'distributor' ), esc_url( $site_url ), esc_html( $site_name ) ) );
}


/**
 * See docblock for distributor_get_original_site_link
 *
 * @param  int $post_id Post ID
 * @since 1.0
 */
function distributor_the_original_site_link( $post_id = null ) {
	echo esc_url( distributor_get_original_site_link( $post_id ) );
}


/**
 * Generate a list of information about a given post.
 *
 * @param int $post_id The Post ID.
 * @return array
 */
function distributor_get_the_connection_source( $post_id = null ) {
	if ( ! $post_id ) {
		global $post;
		$post_id = $post->ID;
	}
	return array(
		'url'               => distributor_get_original_site_url( $post_id ),
		'site_name'         => distributor_get_original_site_name( $post_id ),
		'original_post_url' => distributor_get_original_post_link( $post_id ),
		'post_is_unlinked'  => distributor_is_unlinked( $post_id ),
	);
}

/**
 * Display information about where a post was distributed from.
 *
 * @param int|null|mixed    $post_id Post ID.
 * @param string|null|mixed $preface The string that will precede the link.
 */
function distributor_the_connection_source( $post_id = null, $preface = null ) {
	if ( ! $post_id ) {
		global $post;
		$post_id = $post->ID;
	}

	$connection_data = distributor_get_the_connection_source( $post_id );

	// If the post is unlinked, don't output anything.
	if ( isset( $connection_data['post_is_unlinked'] ) &amp;&amp; 1 === $connection_data['post_is_unlinked'] ) {
		return;
	}

	$preface   = ( $preface ) ? $preface : __( 'Distributed from', 'distributor' );
	$url       = isset( $connection_data['original_post_url'] ) ? $connection_data['original_post_url'] : false;
	$site_name = isset( $connection_data['site_name'] ) ? $connection_data['site_name'] : false;

	if ( $url &amp;&amp; $site_name ) {
		printf( '%s &lt;a href="%s" target="_blank" rel="noopener noreferrer">%s&lt;/a>', esc_html( $preface ), esc_url( $url ), esc_html( $site_name ) );
	}
}

</code></pre>
        </article>
    </section>





    <footer>
		<a href="https://distributorplugin.com/">Distributor Plugin</a> &bull;
		<a href="https://github.com/10up/distributor/">Distributor on GitHub</a> &bull;
		<a href="https://10up.com/careers">Careers at 10up</a>
	</footer>

</div>

<nav>
	
	<h2><a href="index.html">Home</a></h2><h3>Tutorials</h3><ul><li><a href="tutorial-connect-to-an-existing-post.html">Connect to an Existing Post</a></li><li><a href="tutorial-exclude-meta-from-yoast-duplicate-post.html">Exclude Meta from Yoast Duplicate Post</a></li><li><a href="tutorial-migration-guide-version-1-to-version-2.html">Migration Guide Version 1 to Version 2</a></li><li><a href="tutorial-post-meta.html">Post Meta</a></li><li><a href="tutorial-snippets.html">Snippets</a></li></ul><h3>Actions</h3><ul><li><a href="dt_after_set_meta.html">dt_after_set_meta</a></li><li><a href="dt_before_set_meta.html">dt_before_set_meta</a></li><li><a href="dt_link_post.html">dt_link_post</a></li><li><a href="dt_log_sync.html">dt_log_sync</a></li><li><a href="dt_oauth_admin_notices.html">dt_oauth_admin_notices</a></li><li><a href="dt_prepared_taxonomy_terms.html">dt_prepared_taxonomy_terms</a></li><li><a href="dt_process_distributor_attributes.html">dt_process_distributor_attributes</a></li><li><a href="dt_process_subscription_attributes.html">dt_process_subscription_attributes</a></li><li><a href="dt_pull_filters.html">dt_pull_filters</a></li><li><a href="dt_pull_list_table_custom_column.html">dt_pull_list_table_custom_column</a></li><li><a href="dt_pull_post.html">dt_pull_post</a></li><li><a href="dt_push_external_post.html">dt_push_external_post</a></li><li><a href="dt_push_network_post.html">dt_push_network_post</a></li><li><a href="dt_push_post.html">dt_push_post</a></li><li><a href="dt_unlink_post.html">dt_unlink_post</a></li></ul><h3>Filters</h3><ul><li><a href="distributable_post_types.html">distributable_post_types</a></li><li><a href="distributor_get_original_site_link.html">distributor_get_original_site_link</a></li><li><a href="dt_ajax_requires_with_credentials.html">dt_ajax_requires_with_credentials</a></li><li><a href="dt_allow_post_unlink.html">dt_allow_post_unlink</a></li><li><a href="dt_allowed_media_extensions.html">dt_allowed_media_extensions</a></li><li><a href="dt_auth_format_get_args.html">dt_auth_format_get_args</a></li><li><a href="dt_auth_format_post_args.html">dt_auth_format_post_args</a></li><li><a href="dt_auth_prepare_credentials.html">dt_auth_prepare_credentials</a></li><li><a href="dt_authorized_sites.html">dt_authorized_sites</a></li><li><a href="dt_available_pull_post_types.html">dt_available_pull_post_types</a></li><li><a href="dt_available_push_post_types.html">dt_available_push_post_types</a></li><li><a href="dt_capabilities.html">dt_capabilities</a></li><li><a href="dt_create_missing_terms.html">dt_create_missing_terms</a></li><li><a href="dt_debug_info_enabled.html">dt_debug_info_enabled</a></li><li><a href="dt_distributable_post_statuses.html">dt_distributable_post_statuses</a></li><li><a href="dt_excluded_meta.html">dt_excluded_meta</a></li><li><a href="dt_external_capabilities.html">dt_external_capabilities</a></li><li><a href="dt_get_media_details.html">dt_get_media_details</a></li><li><a href="dt_get_pull_content_rest_query_args.html">dt_get_pull_content_rest_query_args</a></li><li><a href="dt_get_rest_url.html">dt_get_rest_url</a></li><li><a href="dt_item_mapping.html">dt_item_mapping</a></li><li><a href="dt_media_item_formatted.html">dt_media_item_formatted</a></li><li><a href="dt_media_processing_filename.html">dt_media_processing_filename</a></li><li><a href="dt_network_site_connection_enabled.html">dt_network_site_connection_enabled</a></li><li><a href="dt_parse_media_blocks.html">dt_parse_media_blocks</a></li><li><a href="dt_post_to_pull.html">dt_post_to_pull</a></li><li><a href="dt_pre_get_authorized_sites.html">dt_pre_get_authorized_sites</a></li><li><a href="dt_prepared_meta.html">dt_prepared_meta</a></li><li><a href="dt_process_media_args.html">dt_process_media_args</a></li><li><a href="dt_process_media_save_source_file_path.html">dt_process_media_save_source_file_path</a></li><li><a href="dt_pull_as_draft.html">dt_pull_as_draft</a></li><li><a href="dt_pull_capabilities.html">dt_pull_capabilities</a></li><li><a href="dt_pull_list_table_columns.html">dt_pull_list_table_columns</a></li><li><a href="dt_pull_list_table_tr_class.html">dt_pull_list_table_tr_class</a></li><li><a href="dt_pull_post_apply_rendered_content.html">dt_pull_post_apply_rendered_content</a></li><li><a href="dt_pull_post_args.html">dt_pull_post_args</a></li><li><a href="dt_pull_post_media.html">dt_pull_post_media</a></li><li><a href="dt_pull_post_meta.html">dt_pull_post_meta</a></li><li><a href="dt_pull_post_terms.html">dt_pull_post_terms</a></li><li><a href="dt_push_capabilities.html">dt_push_capabilities</a></li><li><a href="dt_push_post_args.html">dt_push_post_args</a></li><li><a href="dt_push_post_media.html">dt_push_post_media</a></li><li><a href="dt_push_post_meta.html">dt_push_post_meta</a></li><li><a href="dt_push_post_terms.html">dt_push_post_terms</a></li><li><a href="dt_push_post_timeout.html">dt_push_post_timeout</a></li><li><a href="dt_remote_get.html">dt_remote_get</a></li><li><a href="dt_remote_post.html">dt_remote_post</a></li><li><a href="dt_remote_post_query_args.html">dt_remote_post_query_args</a></li><li><a href="dt_remote_post_timeout.html">dt_remote_post_timeout</a></li><li><a href="dt_set_media_args.html">dt_set_media_args</a></li><li><a href="dt_subscription_post_args.html">dt_subscription_post_args</a></li><li><a href="dt_subscription_post_timeout.html">dt_subscription_post_timeout</a></li><li><a href="dt_sync_media_delete_and_replace.html">dt_sync_media_delete_and_replace</a></li><li><a href="dt_sync_meta.html">dt_sync_meta</a></li><li><a href="dt_syncable_taxonomies.html">dt_syncable_taxonomies</a></li><li><a href="dt_syndicatable_capabilities.html">dt_syndicatable_capabilities</a></li><li><a href="dt_update_content_via_request_args.html">dt_update_content_via_request_args</a></li><li><a href="dt_update_term_hierarchy.html">dt_update_term_hierarchy</a></li><li><a href="dt_use_block_editor_for_post_type.html">dt_use_block_editor_for_post_type</a></li></ul>
</nav>

<br class="clear">

<script> prettyPrint(); </script>
<script src="scripts/linenumber.js"> </script>
</body>
</html>
