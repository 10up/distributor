!function(a){var b=_.memoize(function(a){var b=document.getElementById(a);if(!b)return!1;var c={evaluate:/<#([\s\S]+?)#>/g,interpolate:/\{\{\{([\s\S]+?)\}\}\}/g,escape:/\{\{([^\}]+?)\}\}(?!\})/g};return _.template(b.innerHTML,null,c)}),c=document.getElementsByClassName("external-connection-url-field")[0],d=document.getElementById("sy_external_connection_details"),e=document.getElementById("sy_external_connection_connection"),f=document.getElementsByClassName("external-connection-type-field")[0],g=document.getElementsByClassName("auth-field"),h=document.querySelectorAll("#sy_external_connection_connection .inside")[0],i=document.querySelector(".endpoint-result"),j=!1,k=b("sy-external-connection-verification");a(d).on("keyup change input",".auth-field, .external-connection-url-field",_.debounce(function(b){if(j!==!1&&j.abort(),""==c.value)return h.innerHTML="<p>"+sy.no_connection_check+"</p>",void(i.innerText=sy.will_confirm_endpoint);b.currentTarget.classList.contains("external-connection-url-field")&&(i.classList.add("loading"),i.innerHTML=sy.endpoint_checking_message),e.classList.add("loading");var d={};_.each(g,function(a){var b=a.getAttribute("data-auth-field");b&&(d[b]=a.value)}),j=a.ajax({url:ajaxurl,method:"post",data:{nonce:sy.nonce,action:"sy_verify_external_connection",auth:d,url:c.value,type:f.value}}).done(function(a){a.success?(b.currentTarget.classList.contains("external-connection-url-field")&&(a.data.errors.no_external_connection&&(i.innerHTML='<span class="dashicons dashicons-warning"></span>',i.innerHTML+=sy.invalid_endpoint,a.data.endpoint_suggestion&&(i.innerHTML+=" "+sy.endpoint_suggestion+" <strong>"+a.data.endpoint_suggestion+"</strong>")),Object.keys(a.data.errors).length||(i.innerHTML='<span class="dashicons dashicons-warning"></span>',i.innerHTML+=sy.valid_endpoint)),h.innerHTML=k({errors:a.data.errors,can_post:a.data.can_post,can_get:a.data.can_get})):(b.currentTarget.classList.contains("external-connection-url-field")&&(i.innerHTML='<span class="dashicons dashicons-warning"></span>',i.innerHTML+=sy.invalid_endpoint),h.innerHTML=k({errors:["no_external_connection"],can_post:[],can_get:[]}))}).complete(function(){e.classList.remove("loading"),i.classList.remove("loading")})},250))}(jQuery);