!function(a){function b(b){if(j!==!1&&j.abort(),""==c.value)return void(h.innerText="");h.setAttribute("data-endpoint-state","loading"),h.innerHTML=dt.endpoint_checking_message;var d={};_.each(f,function(a){if(!a.disabled){var b=a.getAttribute("data-auth-field");b&&(d[b]=a.value)}});var g=0;i&&i.value&&(g=i.value),j=a.ajax({url:ajaxurl,method:"post",data:{nonce:dt.nonce,action:"dt_verify_external_connection",auth:d,url:c.value,type:e.value,endpoint_id:g}}).done(function(a){console.log(a),a.success?a.data.errors.no_external_connection?(h.setAttribute("data-endpoint-state","error"),a.data.endpoint_suggestion?h.innerHTML=" "+dt.endpoint_suggestion+' <a class="suggest">'+a.data.endpoint_suggestion+"</a>":h.innerHTML=dt.bad_connection):a.data.errors.no_distributor?(h.setAttribute("data-endpoint-state","warning"),h.innerHTML=dt.limited_connection):a.data.errors.no_types&&(h.setAttribute("data-endpoint-state","valid"),h.innerHTML=dt.successful_connection):h.setAttribute("data-endpoint-state","error")}).complete(function(){h.classList.remove("loading")})}var c=(_.memoize(function(a){var b=document.getElementById(a);if(!b)return!1;var c={evaluate:/<#([\s\S]+?)#>/g,interpolate:/\{\{\{([\s\S]+?)\}\}\}/g,escape:/\{\{([^\}]+?)\}\}(?!\})/g};return _.template(b.innerHTML,null,c)}),document.getElementsByClassName("external-connection-url-field")[0]),d=document.getElementById("dt_external_connection_details"),e=document.getElementsByClassName("external-connection-type-field")[0],f=document.getElementsByClassName("auth-field"),g=document.getElementById("title"),h=document.querySelector(".endpoint-result"),i=document.getElementById("post_ID"),j=!1;setTimeout(function(){b()},300),a(d).on("click",".suggest",function(b){c.value=b.currentTarget.innerText,a(c).trigger("input")}),a(d).on("keyup input",".auth-field, .external-connection-url-field",_.debounce(b,250)),a(c).on("blur",function(a){""===g.value&&""!==a.currentTarget.value&&(g.value=a.currentTarget.value.replace(/https?:\/\//i,""),g.focus(),g.blur())});var k=document.getElementById("dt_password"),l=document.getElementById("dt_username"),m=document.querySelector(".change-password");a(l).on("keyup change",_.debounce(function(){m&&(k.disabled=!1,k.value="",m.style.display="none")},250)),a(m).on("click",function(a){a.preventDefault(),k.disabled?(k.disabled=!1,k.value="",a.currentTarget.innerText=dt.cancel):(k.disabled=!0,k.value="sdfdsfsdfdsfdsfsd",a.currentTarget.innerText=dt.change),b()})}(jQuery);