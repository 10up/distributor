!function(a){var b={},c="";a(window).load(function(){function d(){h.classList.add("message-error"),setTimeout(function(){h.classList.remove("message-error")},6e3)}function e(a){var c=!1;_.each(a.internal,function(a,b){"fail"===a.status?c=!0:sy_connections["internal"+b].syndicated=!0}),_.each(a.external,function(a){"fail"===a.status?c=!0:sy_connections["external"+connectionId].syndicated=!0}),c?d():(h.classList.add("message-success"),_.each(b,function(a,b){sy_connections[b].syndicated=!0}),b={},i.classList.add("empty"),j.innerHTML="",setTimeout(function(){h.classList.remove("message-success")},6e3)),f()}function f(){k.innerHTML="",_.each(sy_connections,function(a,d){if(""!==c){var e=a.name.replace(/[^0-9a-zA-Z ]+/,"").match(c),f=a.url.replace(/https?:\/\//i,"").replace(/www/i,"").replace(/[^0-9a-zA-Z ]+/,"").match(c);if(!e&&!f)return}var g=document.createElement("a");"external"===sy_connections[d].type?g.innerText=a.name:g.innerText=a.url,g.setAttribute("data-connection-type",a.type),g.setAttribute("data-connection-id",a.id),b[a.type+a.id]&&g.classList.add("added"),g.classList.add("add-connection"),a.syndicated&&g.classList.add("syndicated"),k.appendChild(g)})}var g=document.querySelector("#wp-admin-bar-syndicate a"),h=document.querySelector(".syndicate-push-wrapper"),i=h.querySelector(".connections-selected"),j=i.querySelector(".selected-connections-list"),k=h.querySelector(".new-connections-list"),l=document.getElementById("sy-connection-search"),m=document.getElementById("syndicate-as-draft"),n=h.querySelector(".syndicate-button"),o=h.querySelector(".action-wrapper");a(n).on("click",function(c){o.classList.contains("loading")||(o.classList.add("loading"),a.ajax({url:sy.ajaxurl,method:"post",data:{action:"sy_push",draft:m.checked?1:0,nonce:sy.nonce,connections:b,post_id:sy.post_id}}).done(function(a){setTimeout(function(){return o.classList.remove("loading"),a.data&&a.data.results?void e(a.data.results):void d()},500)}).error(function(){setTimeout(function(){o.classList.remove("loading"),d()},500)}))}),a(g).on("click",function(a){a.preventDefault(),document.body.classList.contains("syndicate-show")?g.blur():g.focus(),document.body.classList.toggle("syndicate-show")}),a(h).on("click",".add-connection",function(a){if(a.preventDefault(),!a.currentTarget.classList.contains("syndicated")&&!a.currentTarget.classList.contains("added")){var c=a.currentTarget.getAttribute("data-connection-type"),d=a.currentTarget.getAttribute("data-connection-id");b[c+d]=sy_connections[c+d],i.classList.remove("empty");var e=a.currentTarget.cloneNode();e.innerText=a.currentTarget.innerText,e.innerHTML+='<span class="remove-connection"></span>',e.classList="added-connection",j.appendChild(e),f()}}),a(h).on("click",".remove-connection",function(a){a.currentTarget.parentNode.parentNode.removeChild(a.currentTarget.parentNode);var c=a.currentTarget.parentNode.getAttribute("data-connection-type"),d=a.currentTarget.parentNode.getAttribute("data-connection-id");delete b[c+d],Object.keys(b).length||i.classList.add("empty"),f()}),a(l).on("keyup change",_.debounce(function(a){""===a.currentTarget.value&&f(sy_connections),c=a.currentTarget.value.replace(/https?:\/\//i,"").replace(/www/i,"").replace(/[^0-9a-zA-Z ]+/,""),f()},300))})}(jQuery);