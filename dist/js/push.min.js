!function(e){function t(r){if(n[r])return n[r].exports;var a=n[r]={i:r,l:!1,exports:{}};return e[r].call(a.exports,a,a.exports,t),a.l=!0,a.exports}var n={};t.m=e,t.c=n,t.d=function(e,n,r){t.o(e,n)||Object.defineProperty(e,n,{configurable:!1,enumerable:!0,get:r})},t.n=function(e){var n=e&&e.__esModule?function(){return e.default}:function(){return e};return t.d(n,"a",n),n},t.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},t.p="",t(t.s=6)}([function(e,t){e.exports=jQuery},function(e,t){e.exports=_},function(e,t){e.exports=window},,,,function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{default:e}}var a=n(0),o=r(a),c=n(1),i=r(c),s=n(2),d={},u="",l=i.default.memoize(function(e){var t=document.getElementById(e);if(!t)return!1;var n={evaluate:/<#([\s\S]+?)#>/g,interpolate:/{{{([\s\S]+?)}}}/g,escape:/{{([^}]+?)}}(?!})/g};return i.default.template(t.innerHTML,null,n)});(0,o.default)(window).load(function(){function e(){a.classList.add("message-error"),setTimeout(function(){a.classList.remove("message-error")},6e3)}function t(t){var r=!1;i.default.each(t.internal,function(e,t){"fail"===e.status?r=!0:s.dtConnections["internal"+t].syndicated=e.url}),i.default.each(t.external,function(e,t){"fail"===e.status?r=!0:s.dtConnections["external"+t].syndicated=!0}),r?e():(a.classList.add("message-success"),c.classList.add("empty"),f.innerText="",setTimeout(function(){a.classList.remove("message-success")},6e3)),d={},n()}function n(){p.innerText="",i.default.each(s.dtConnections,function(e){if(""!==u){var t=e.name.replace(/[^0-9a-zA-Z ]+/,"").toLowerCase().match(u.toLowerCase()),n=e.url.replace(/https?:\/\//i,"").replace(/www/i,"").replace(/[^0-9a-zA-Z ]+/,"").toLowerCase().match(u.toLowerCase());if(!t&&!n)return}var r=l("dt-add-connection")({connection:e,selectedConnections:d});p.innerHTML+=r})}var r=document.querySelector("#wp-admin-bar-distributor"),a=document.querySelector("#distributor-push-wrapper"),c=a.querySelector(".connections-selected"),f=a.querySelector(".selected-connections-list"),p=a.querySelector(".new-connections-list"),m=document.getElementById("dt-connection-search"),g=a.querySelector(".syndicate-button"),v=a.querySelector(".action-wrapper"),y=document.getElementById("dt-as-draft");r.appendChild(a),(0,o.default)(g).on("click",function(){if(!v.classList.contains("loading")){v.classList.add("loading");var n={action:"dt_push",nonce:s.dt.nonce,connections:d,post_id:s.dt.post_id};y.checked&&(n.draft=!0),o.default.ajax({url:s.dt.ajaxurl,method:"post",data:n}).done(function(n){setTimeout(function(){if(v.classList.remove("loading"),!n.data||!n.data.results)return void e();t(n.data.results)},500)}).error(function(){setTimeout(function(){v.classList.remove("loading"),e()},500)})}}),(0,o.default)(a).on("click",".add-connection",function(e){if("A"!==e.target.nodeName&&(e.preventDefault(),!e.currentTarget.classList.contains("syndicated")))if(e.currentTarget.classList.contains("added")){var t=e.currentTarget.getAttribute("data-connection-type"),r=e.currentTarget.getAttribute("data-connection-id"),a=f.querySelector('[data-connection-id="'+r+'"][data-connection-type="'+t+'"]');a.parentNode.removeChild(a),delete d[t+r],Object.keys(d).length||c.classList.add("empty"),n()}else{var o=e.currentTarget.getAttribute("data-connection-type"),i=e.currentTarget.getAttribute("data-connection-id");d[o+i]=s.dtConnections[o+i],c.classList.remove("empty");var u=e.currentTarget.cloneNode();u.innerText=e.currentTarget.innerText;var l=document.createElement("span");l.classList.add("remove-connection"),u.appendChild(l),u.classList="added-connection",f.appendChild(u),n()}}),(0,o.default)(a).on("click",".remove-connection",function(e){e.currentTarget.parentNode.parentNode.removeChild(e.currentTarget.parentNode);var t=e.currentTarget.parentNode.getAttribute("data-connection-type"),r=e.currentTarget.parentNode.getAttribute("data-connection-id");delete d[t+r],Object.keys(d).length||c.classList.add("empty"),n()}),(0,o.default)(m).on("keyup change",i.default.debounce(function(e){""===e.currentTarget.value&&n(s.dtConnections),u=e.currentTarget.value.replace(/https?:\/\//i,"").replace(/www/i,"").replace(/[^0-9a-zA-Z ]+/,""),n()},300))})}]);
//# sourceMappingURL=push.min.js.map