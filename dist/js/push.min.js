!function(e){function t(a){if(n[a])return n[a].exports;var o=n[a]={i:a,l:!1,exports:{}};return e[a].call(o.exports,o,o.exports,t),o.l=!0,o.exports}var n={};t.m=e,t.c=n,t.d=function(e,n,a){t.o(e,n)||Object.defineProperty(e,n,{configurable:!1,enumerable:!0,get:a})},t.n=function(e){var n=e&&e.__esModule?function(){return e.default}:function(){return e};return t.d(n,"a",n),n},t.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},t.p="",t(t.s=6)}([function(e,t){e.exports=jQuery},function(e,t){e.exports=window},function(e,t){e.exports=_},,,,function(e,t,n){"use strict";function a(e){return e&&e.__esModule?e:{default:e}}var o=n(0),r=a(o),c=n(2),s=a(c),i=n(1),d={},u="",l=s.default.memoize(function(e){var t=document.getElementById(e);if(!t)return!1;var n={evaluate:/<#([\s\S]+?)#>/g,interpolate:/{{{([\s\S]+?)}}}/g,escape:/{{([^}]+?)}}(?!})/g};return s.default.template(t.innerHTML,null,n)});(0,r.default)(window).on("load",function(){function e(){g=p.querySelector(".connections-selected"),v=p.querySelector(".selected-connections-list"),h=p.querySelector(".new-connections-list"),y=document.getElementById("dt-connection-search"),L=p.querySelector(".action-wrapper"),T=document.getElementById("dt-post-status"),w=document.getElementById("dt-as-draft"),(0,r.default)(y).on("keyup change",s.default.debounce(function(e){""===e.currentTarget.value&&a(),u=e.currentTarget.value.replace(/https?:\/\//i,"").replace(/www/i,"").replace(/[^0-9a-zA-Z ]+/,""),a()},300))}function t(){p.classList.add("message-error"),setTimeout(function(){p.classList.remove("message-error")},6e3)}function n(e){var n=!1;s.default.each(e.internal,function(e,t){"fail"===e.status?n=!0:m["internal"+t].syndicated=e.url}),s.default.each(e.external,function(e,t){"fail"===e.status?n=!0:m["external"+t].syndicated=!0}),n?t():(p.classList.add("message-success"),g.classList.add("empty"),v.innerText="",setTimeout(function(){p.classList.remove("message-success")},6e3)),d={},a()}function a(){h.innerText="",s.default.each(m,function(e){if(""!==u){var t=e.name.replace(/[^0-9a-zA-Z ]+/,"").toLowerCase().match(u.toLowerCase()),n=e.url.replace(/https?:\/\//i,"").replace(/www/i,"").replace(/[^0-9a-zA-Z ]+/,"").toLowerCase().match(u.toLowerCase());if(!t&&!n)return}var a=l("dt-add-connection")({connection:e,selectedConnections:d});h.innerHTML+=a})}function o(){if(f.focus(),document.body.classList.toggle("distributor-show"),!p.classList.contains("loaded")){p.classList.remove("message-error"),p.classList.add("loaded");var t={action:"dt_load_connections",loadConnectionsNonce:i.dt.loadConnectionsNonce,postId:i.dt.postId},n=!!i.dt.usexhr&&{withCredentials:!0};r.default.ajax({url:i.dt.ajaxurl,xhrFields:n,method:"post",data:t}).done(function(t){if(!t.success||!t.data)return p.classList.remove("loaded"),void p.classList.add("message-error");m=t.data,p.innerHTML=l("dt-show-connections")({connections:m}),e()}).error(function(){p.classList.remove("loaded"),p.classList.add("message-error")})}}function c(){f.blur(),document.body.classList.toggle("distributor-show")}var f=document.querySelector("#wp-admin-bar-distributor"),p=document.querySelector("#distributor-push-wrapper");if(f&&p){var m="",g="",v="",h="",y="",L="",T="",w="";f.appendChild(p),(0,r.default)(f).hoverIntent(o,300,c),(0,r.default)(p).on("click",".syndicate-button",function(){if(!L.classList.contains("loading")){L.classList.add("loading");var e={action:"dt_push",nonce:i.dt.nonce,connections:d,postId:i.dt.postId};e.postStatus=null!==w&&w.checked?"draft":T.value;var a=!!i.dt.usexhr&&{withCredentials:!0};r.default.ajax({url:i.dt.ajaxurl,xhrFields:a,method:"post",data:e}).done(function(e){setTimeout(function(){if(L.classList.remove("loading"),!e.data||!e.data.results)return void t();n(e.data.results)},500)}).error(function(){setTimeout(function(){L.classList.remove("loading"),t()},500)})}}),(0,r.default)(p).on("click",".add-connection",function(e){if("A"!==e.target.nodeName&&(e.preventDefault(),!e.currentTarget.classList.contains("syndicated")))if(e.currentTarget.classList.contains("added")){var t=e.currentTarget.getAttribute("data-connection-type"),n=e.currentTarget.getAttribute("data-connection-id"),o=v.querySelector('[data-connection-id="'+n+'"][data-connection-type="'+t+'"]');o.parentNode.removeChild(o),delete d[t+n],Object.keys(d).length||g.classList.add("empty"),a()}else{var r=e.currentTarget.getAttribute("data-connection-type"),c=e.currentTarget.getAttribute("data-connection-id");d[r+c]=m[r+c],g.classList.remove("empty");var s=e.currentTarget.cloneNode();s.innerText=e.currentTarget.innerText;var i=document.createElement("span");i.classList.add("remove-connection"),s.appendChild(i),s.classList="added-connection",v.appendChild(s),a()}}),(0,r.default)(p).on("click",".remove-connection",function(e){e.currentTarget.parentNode.parentNode.removeChild(e.currentTarget.parentNode);var t=e.currentTarget.parentNode.getAttribute("data-connection-type"),n=e.currentTarget.parentNode.getAttribute("data-connection-id");delete d[t+n],Object.keys(d).length||g.classList.add("empty"),a()})}})}]);
//# sourceMappingURL=push.min.js.map