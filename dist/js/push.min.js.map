{"version":3,"sources":["webpack:///push.min.js","webpack:///webpack/bootstrap 3e691cf28c650bcf2f15","webpack:///external \"jQuery\"","webpack:///external \"_\"","webpack:///external \"window\"","webpack:///./assets/js/push.js"],"names":["modules","__webpack_require__","moduleId","installedModules","exports","module","i","l","call","m","c","d","name","getter","o","Object","defineProperty","configurable","enumerable","get","n","__esModule","object","property","prototype","hasOwnProperty","p","s","jQuery","_","window","_interopRequireDefault","obj","default","_jquery","_jquery2","_underscores","_underscores2","_window","selectedConnections","searchString","processTemplate","memoize","id","element","document","getElementById","options","evaluate","interpolate","escape","template","innerHTML","load","doError","distributorPushWrapper","classList","add","setTimeout","remove","doSuccess","results","error","each","internal","result","connectionId","status","dtConnections","syndicated","url","external","connectionsSelected","connectionsSelectedList","innerText","showConnections","connectionsNewList","connection","nameMatch","replace","toLowerCase","match","urlMatch","showConnection","distributorMenuItem","querySelector","connectionsSearchInput","syndicateButton","actionWrapper","asDraftInput","appendChild","on","contains","data","action","nonce","dt","connections","post_id","checked","draft","ajax","ajaxurl","method","done","response","event","target","nodeName","preventDefault","currentTarget","type","getAttribute","deleteNode","parentNode","removeChild","keys","length","cloneNode","removeLink","createElement","debounce","value"],"mappings":"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","file":"push.min.js","sourcesContent":["/******/ (function(modules) { // webpackBootstrap\n/******/ \t// The module cache\n/******/ \tvar installedModules = {};\n/******/\n/******/ \t// The require function\n/******/ \tfunction __webpack_require__(moduleId) {\n/******/\n/******/ \t\t// Check if module is in cache\n/******/ \t\tif(installedModules[moduleId]) {\n/******/ \t\t\treturn installedModules[moduleId].exports;\n/******/ \t\t}\n/******/ \t\t// Create a new module (and put it into the cache)\n/******/ \t\tvar module = installedModules[moduleId] = {\n/******/ \t\t\ti: moduleId,\n/******/ \t\t\tl: false,\n/******/ \t\t\texports: {}\n/******/ \t\t};\n/******/\n/******/ \t\t// Execute the module function\n/******/ \t\tmodules[moduleId].call(module.exports, module, module.exports, __webpack_require__);\n/******/\n/******/ \t\t// Flag the module as loaded\n/******/ \t\tmodule.l = true;\n/******/\n/******/ \t\t// Return the exports of the module\n/******/ \t\treturn module.exports;\n/******/ \t}\n/******/\n/******/\n/******/ \t// expose the modules object (__webpack_modules__)\n/******/ \t__webpack_require__.m = modules;\n/******/\n/******/ \t// expose the module cache\n/******/ \t__webpack_require__.c = installedModules;\n/******/\n/******/ \t// define getter function for harmony exports\n/******/ \t__webpack_require__.d = function(exports, name, getter) {\n/******/ \t\tif(!__webpack_require__.o(exports, name)) {\n/******/ \t\t\tObject.defineProperty(exports, name, {\n/******/ \t\t\t\tconfigurable: false,\n/******/ \t\t\t\tenumerable: true,\n/******/ \t\t\t\tget: getter\n/******/ \t\t\t});\n/******/ \t\t}\n/******/ \t};\n/******/\n/******/ \t// getDefaultExport function for compatibility with non-harmony modules\n/******/ \t__webpack_require__.n = function(module) {\n/******/ \t\tvar getter = module && module.__esModule ?\n/******/ \t\t\tfunction getDefault() { return module['default']; } :\n/******/ \t\t\tfunction getModuleExports() { return module; };\n/******/ \t\t__webpack_require__.d(getter, 'a', getter);\n/******/ \t\treturn getter;\n/******/ \t};\n/******/\n/******/ \t// Object.prototype.hasOwnProperty.call\n/******/ \t__webpack_require__.o = function(object, property) { return Object.prototype.hasOwnProperty.call(object, property); };\n/******/\n/******/ \t// __webpack_public_path__\n/******/ \t__webpack_require__.p = \"\";\n/******/\n/******/ \t// Load entry module and return exports\n/******/ \treturn __webpack_require__(__webpack_require__.s = 6);\n/******/ })\n/************************************************************************/\n/******/ ([\n/* 0 */\n/***/ (function(module, exports) {\n\nmodule.exports = jQuery;\n\n/***/ }),\n/* 1 */\n/***/ (function(module, exports) {\n\nmodule.exports = _;\n\n/***/ }),\n/* 2 */\n/***/ (function(module, exports) {\n\nmodule.exports = window;\n\n/***/ }),\n/* 3 */,\n/* 4 */,\n/* 5 */,\n/* 6 */\n/***/ (function(module, exports, __webpack_require__) {\n\n\"use strict\";\n\n\nvar _jquery = __webpack_require__(0);\n\nvar _jquery2 = _interopRequireDefault(_jquery);\n\nvar _underscores = __webpack_require__(1);\n\nvar _underscores2 = _interopRequireDefault(_underscores);\n\nvar _window = __webpack_require__(2);\n\nfunction _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { default: obj }; }\n\nvar selectedConnections = {},\n    searchString = '';\n\nvar processTemplate = _underscores2.default.memoize(function (id) {\n\tvar element = document.getElementById(id);\n\tif (!element) {\n\t\treturn false;\n\t}\n\n\t// Use WordPress style Backbone template syntax\n\tvar options = {\n\t\tevaluate: /<#([\\s\\S]+?)#>/g,\n\t\tinterpolate: /{{{([\\s\\S]+?)}}}/g,\n\t\tescape: /{{([^}]+?)}}(?!})/g\n\t};\n\n\treturn _underscores2.default.template(element.innerHTML, null, options);\n});\n\n(0, _jquery2.default)(window).load(function () {\n\tvar distributorMenuItem = document.querySelector('#wp-admin-bar-distributor');\n\tvar distributorPushWrapper = document.querySelector('#distributor-push-wrapper');\n\tvar connectionsSelected = distributorPushWrapper.querySelector('.connections-selected');\n\tvar connectionsSelectedList = distributorPushWrapper.querySelector('.selected-connections-list');\n\tvar connectionsNewList = distributorPushWrapper.querySelector('.new-connections-list');\n\tvar connectionsSearchInput = document.getElementById('dt-connection-search');\n\tvar syndicateButton = distributorPushWrapper.querySelector('.syndicate-button');\n\tvar actionWrapper = distributorPushWrapper.querySelector('.action-wrapper');\n\tvar asDraftInput = document.getElementById('dt-as-draft');\n\n\tdistributorMenuItem.appendChild(distributorPushWrapper);\n\n\t/**\n \t * Handle UI error changes\n \t */\n\tfunction doError() {\n\t\tdistributorPushWrapper.classList.add('message-error');\n\n\t\tsetTimeout(function () {\n\t\t\tdistributorPushWrapper.classList.remove('message-error');\n\t\t}, 6000);\n\t}\n\n\t/**\n \t * Handle UI success changes\n \t */\n\tfunction doSuccess(results) {\n\t\tvar error = false;\n\n\t\t_underscores2.default.each(results.internal, function (result, connectionId) {\n\t\t\tif (result.status === 'fail') {\n\t\t\t\terror = true;\n\t\t\t} else {\n\t\t\t\t_window.dtConnections['internal' + connectionId].syndicated = result.url;\n\t\t\t}\n\t\t});\n\n\t\t_underscores2.default.each(results.external, function (result, connectionId) {\n\t\t\tif (result.status === 'fail') {\n\t\t\t\terror = true;\n\t\t\t} else {\n\t\t\t\t_window.dtConnections['external' + connectionId].syndicated = true;\n\t\t\t}\n\t\t});\n\n\t\tif (error) {\n\t\t\tdoError();\n\t\t} else {\n\t\t\tdistributorPushWrapper.classList.add('message-success');\n\n\t\t\tconnectionsSelected.classList.add('empty');\n\t\t\tconnectionsSelectedList.innerText = '';\n\n\t\t\tsetTimeout(function () {\n\t\t\t\tdistributorPushWrapper.classList.remove('message-success');\n\t\t\t}, 6000);\n\t\t}\n\n\t\tselectedConnections = {};\n\n\t\tshowConnections();\n\t}\n\n\t/**\n \t * Show connections. If there is a search string, then filter by it\n \t */\n\tfunction showConnections() {\n\t\tconnectionsNewList.innerText = '';\n\n\t\t_underscores2.default.each(_window.dtConnections, function (connection) {\n\t\t\tif (searchString !== '') {\n\t\t\t\tvar nameMatch = connection.name.replace(/[^0-9a-zA-Z ]+/, '').toLowerCase().match(searchString.toLowerCase());\n\t\t\t\tvar urlMatch = connection.url.replace(/https?:\\/\\//i, '').replace(/www/i, '').replace(/[^0-9a-zA-Z ]+/, '').toLowerCase().match(searchString.toLowerCase());\n\n\t\t\t\tif (!nameMatch && !urlMatch) {\n\t\t\t\t\treturn;\n\t\t\t\t}\n\t\t\t}\n\n\t\t\tvar showConnection = processTemplate('dt-add-connection')({\n\t\t\t\tconnection: connection,\n\t\t\t\tselectedConnections: selectedConnections\n\t\t\t});\n\n\t\t\tconnectionsNewList.innerHTML += showConnection;\n\t\t});\n\t}\n\n\t/**\n  * Do syndication ajax\n  */\n\t(0, _jquery2.default)(syndicateButton).on('click', function () {\n\t\tif (actionWrapper.classList.contains('loading')) {\n\t\t\treturn;\n\t\t}\n\n\t\tactionWrapper.classList.add('loading');\n\n\t\tvar data = {\n\t\t\taction: 'dt_push',\n\t\t\tnonce: _window.dt.nonce,\n\t\t\tconnections: selectedConnections,\n\t\t\tpost_id: _window.dt.post_id\n\t\t};\n\n\t\tif (asDraftInput.checked) {\n\t\t\tdata.draft = true;\n\t\t}\n\n\t\t_jquery2.default.ajax({\n\t\t\turl: _window.dt.ajaxurl,\n\t\t\tmethod: 'post',\n\t\t\tdata: data\n\t\t}).done(function (response) {\n\t\t\tsetTimeout(function () {\n\t\t\t\tactionWrapper.classList.remove('loading');\n\n\t\t\t\tif (!response.data || !response.data.results) {\n\t\t\t\t\tdoError();\n\t\t\t\t\treturn;\n\t\t\t\t}\n\n\t\t\t\tdoSuccess(response.data.results);\n\t\t\t}, 500);\n\t\t}).error(function () {\n\t\t\tsetTimeout(function () {\n\t\t\t\tactionWrapper.classList.remove('loading');\n\n\t\t\t\tdoError();\n\t\t\t}, 500);\n\t\t});\n\t});\n\n\t/**\n  * Add a connection to selected connections for ajax and to the UI list.\n  */\n\t(0, _jquery2.default)(distributorPushWrapper).on('click', '.add-connection', function (event) {\n\t\tif (event.target.nodeName === 'A') {\n\t\t\treturn;\n\t\t}\n\n\t\tevent.preventDefault();\n\n\t\tif (event.currentTarget.classList.contains('syndicated')) {\n\t\t\treturn;\n\t\t}\n\n\t\tif (event.currentTarget.classList.contains('added')) {\n\n\t\t\tvar type = event.currentTarget.getAttribute('data-connection-type');\n\t\t\tvar id = event.currentTarget.getAttribute('data-connection-id');\n\n\t\t\tvar deleteNode = connectionsSelectedList.querySelector('[data-connection-id=\"' + id + '\"][data-connection-type=\"' + type + '\"]');\n\n\t\t\tdeleteNode.parentNode.removeChild(deleteNode);\n\n\t\t\tdelete selectedConnections[type + id];\n\n\t\t\tif (!Object.keys(selectedConnections).length) {\n\t\t\t\tconnectionsSelected.classList.add('empty');\n\t\t\t}\n\n\t\t\tshowConnections();\n\t\t} else {\n\n\t\t\tvar _type = event.currentTarget.getAttribute('data-connection-type');\n\t\t\tvar _id = event.currentTarget.getAttribute('data-connection-id');\n\n\t\t\tselectedConnections[_type + _id] = _window.dtConnections[_type + _id];\n\n\t\t\tconnectionsSelected.classList.remove('empty');\n\n\t\t\tvar element = event.currentTarget.cloneNode();\n\t\t\telement.innerText = event.currentTarget.innerText;\n\n\t\t\tvar removeLink = document.createElement('span');\n\t\t\tremoveLink.classList.add('remove-connection');\n\n\t\t\telement.appendChild(removeLink);\n\t\t\telement.classList = 'added-connection';\n\n\t\t\tconnectionsSelectedList.appendChild(element);\n\n\t\t\tshowConnections();\n\t\t}\n\t});\n\n\t/**\n  * Remove a connection from selected connections and the UI list\n  */\n\t(0, _jquery2.default)(distributorPushWrapper).on('click', '.remove-connection', function (event) {\n\t\tevent.currentTarget.parentNode.parentNode.removeChild(event.currentTarget.parentNode);\n\t\tvar type = event.currentTarget.parentNode.getAttribute('data-connection-type');\n\t\tvar id = event.currentTarget.parentNode.getAttribute('data-connection-id');\n\n\t\tdelete selectedConnections[type + id];\n\n\t\tif (!Object.keys(selectedConnections).length) {\n\t\t\tconnectionsSelected.classList.add('empty');\n\t\t}\n\n\t\tshowConnections();\n\t});\n\n\t/**\n  * List for connection filtering\n  */\n\t(0, _jquery2.default)(connectionsSearchInput).on('keyup change', _underscores2.default.debounce(function (event) {\n\t\tif (event.currentTarget.value === '') {\n\t\t\tshowConnections(_window.dtConnections);\n\t\t}\n\n\t\tsearchString = event.currentTarget.value.replace(/https?:\\/\\//i, '').replace(/www/i, '').replace(/[^0-9a-zA-Z ]+/, '');\n\n\t\tshowConnections();\n\t}, 300));\n});\n\n/***/ })\n/******/ ]);\n\n\n// WEBPACK FOOTER //\n// push.min.js"," \t// The module cache\n \tvar installedModules = {};\n\n \t// The require function\n \tfunction __webpack_require__(moduleId) {\n\n \t\t// Check if module is in cache\n \t\tif(installedModules[moduleId]) {\n \t\t\treturn installedModules[moduleId].exports;\n \t\t}\n \t\t// Create a new module (and put it into the cache)\n \t\tvar module = installedModules[moduleId] = {\n \t\t\ti: moduleId,\n \t\t\tl: false,\n \t\t\texports: {}\n \t\t};\n\n \t\t// Execute the module function\n \t\tmodules[moduleId].call(module.exports, module, module.exports, __webpack_require__);\n\n \t\t// Flag the module as loaded\n \t\tmodule.l = true;\n\n \t\t// Return the exports of the module\n \t\treturn module.exports;\n \t}\n\n\n \t// expose the modules object (__webpack_modules__)\n \t__webpack_require__.m = modules;\n\n \t// expose the module cache\n \t__webpack_require__.c = installedModules;\n\n \t// define getter function for harmony exports\n \t__webpack_require__.d = function(exports, name, getter) {\n \t\tif(!__webpack_require__.o(exports, name)) {\n \t\t\tObject.defineProperty(exports, name, {\n \t\t\t\tconfigurable: false,\n \t\t\t\tenumerable: true,\n \t\t\t\tget: getter\n \t\t\t});\n \t\t}\n \t};\n\n \t// getDefaultExport function for compatibility with non-harmony modules\n \t__webpack_require__.n = function(module) {\n \t\tvar getter = module && module.__esModule ?\n \t\t\tfunction getDefault() { return module['default']; } :\n \t\t\tfunction getModuleExports() { return module; };\n \t\t__webpack_require__.d(getter, 'a', getter);\n \t\treturn getter;\n \t};\n\n \t// Object.prototype.hasOwnProperty.call\n \t__webpack_require__.o = function(object, property) { return Object.prototype.hasOwnProperty.call(object, property); };\n\n \t// __webpack_public_path__\n \t__webpack_require__.p = \"\";\n\n \t// Load entry module and return exports\n \treturn __webpack_require__(__webpack_require__.s = 6);\n\n\n\n// WEBPACK FOOTER //\n// webpack/bootstrap 3e691cf28c650bcf2f15","module.exports = jQuery;\n\n\n//////////////////\n// WEBPACK FOOTER\n// external \"jQuery\"\n// module id = 0\n// module chunks = 0 1 2 3","module.exports = _;\n\n\n//////////////////\n// WEBPACK FOOTER\n// external \"_\"\n// module id = 1\n// module chunks = 0 1","module.exports = window;\n\n\n//////////////////\n// WEBPACK FOOTER\n// external \"window\"\n// module id = 2\n// module chunks = 0 1","import jQuery from 'jquery'\nimport _ from 'underscores'\nimport { dt, dtConnections } from 'window'\n\nlet selectedConnections = {},\n\tsearchString        = ''\n\nconst processTemplate = _.memoize( ( id ) => {\n\tconst element = document.getElementById( id )\n\tif ( ! element ) {\n\t\treturn false\n\t}\n\n\t// Use WordPress style Backbone template syntax\n\tconst options = {\n\t\tevaluate:    /<#([\\s\\S]+?)#>/g,\n\t\tinterpolate: /{{{([\\s\\S]+?)}}}/g,\n\t\tescape:      /{{([^}]+?)}}(?!})/g\n\t}\n\n\treturn _.template( element.innerHTML, null, options )\n} )\n\njQuery( window ).load( () => {\n\tconst distributorMenuItem     = document.querySelector( '#wp-admin-bar-distributor' )\n\tconst distributorPushWrapper  = document.querySelector( '#distributor-push-wrapper' )\n\tconst connectionsSelected     = distributorPushWrapper.querySelector( '.connections-selected' )\n\tconst connectionsSelectedList = distributorPushWrapper.querySelector( '.selected-connections-list' )\n\tconst connectionsNewList      = distributorPushWrapper.querySelector( '.new-connections-list' )\n\tconst connectionsSearchInput  = document.getElementById( 'dt-connection-search' )\n\tconst syndicateButton         = distributorPushWrapper.querySelector( '.syndicate-button' )\n\tconst actionWrapper           = distributorPushWrapper.querySelector( '.action-wrapper' )\n\tconst asDraftInput            = document.getElementById( 'dt-as-draft' )\n\n\tdistributorMenuItem.appendChild( distributorPushWrapper )\n\n\t/**\n\t\t * Handle UI error changes\n\t\t */\n\tfunction doError() {\n\t\tdistributorPushWrapper.classList.add( 'message-error' )\n\n\t\tsetTimeout( () => {\n\t\t\tdistributorPushWrapper.classList.remove( 'message-error' )\n\t\t}, 6000 )\n\t}\n\n\t/**\n\t\t * Handle UI success changes\n\t\t */\n\tfunction doSuccess( results ) {\n\t\tlet error = false\n\n\t\t_.each( results.internal, ( result, connectionId ) => {\n\t\t\tif ( result.status === 'fail' ) {\n\t\t\t\terror = true\n\t\t\t} else {\n\t\t\t\tdtConnections['internal' + connectionId].syndicated = result.url\n\t\t\t}\n\t\t} )\n\n\t\t_.each( results.external, ( result, connectionId ) => {\n\t\t\tif ( result.status === 'fail' ) {\n\t\t\t\terror = true\n\t\t\t} else {\n\t\t\t\tdtConnections['external' + connectionId].syndicated = true\n\t\t\t}\n\t\t} )\n\n\t\tif ( error ) {\n\t\t\tdoError()\n\t\t} else {\n\t\t\tdistributorPushWrapper.classList.add( 'message-success' )\n\n\t\t\tconnectionsSelected.classList.add( 'empty' )\n\t\t\tconnectionsSelectedList.innerText = ''\n\n\t\t\tsetTimeout( () => {\n\t\t\t\tdistributorPushWrapper.classList.remove( 'message-success' )\n\t\t\t}, 6000 )\n\t\t}\n\n\t\tselectedConnections = {}\n\n\t\tshowConnections()\n\t}\n\n\t/**\n\t\t * Show connections. If there is a search string, then filter by it\n\t\t */\n\tfunction showConnections() {\n\t\tconnectionsNewList.innerText = ''\n\n\t\t_.each( dtConnections, ( connection ) => {\n\t\t\tif ( searchString !== '' ) {\n\t\t\t\tlet nameMatch = connection.name.replace( /[^0-9a-zA-Z ]+/, '' ).toLowerCase().match( searchString.toLowerCase() )\n\t\t\t\tlet urlMatch  = connection.url.replace( /https?:\\/\\//i, '' ).replace( /www/i, '' ).replace( /[^0-9a-zA-Z ]+/, '' ).toLowerCase().match( searchString.toLowerCase() )\n\n\t\t\t\tif ( ! nameMatch && ! urlMatch ) {\n\t\t\t\t\treturn\n\t\t\t\t}\n\t\t\t}\n\n\t\t\tconst showConnection = processTemplate( 'dt-add-connection' )( {\n\t\t\t\tconnection: connection,\n\t\t\t\tselectedConnections: selectedConnections\n\t\t\t} )\n\n\t\t\tconnectionsNewList.innerHTML += showConnection\n\t\t} )\n\t}\n\n\t/**\n\t * Do syndication ajax\n\t */\n\tjQuery( syndicateButton ).on( 'click', () => {\n\t\tif ( actionWrapper.classList.contains( 'loading' ) ) {\n\t\t\treturn\n\t\t}\n\n\t\tactionWrapper.classList.add( 'loading' )\n\n\t\tconst data = {\n\t\t\taction: 'dt_push',\n\t\t\tnonce: dt.nonce,\n\t\t\tconnections: selectedConnections,\n\t\t\tpost_id: dt.post_id\n\t\t}\n\n\t\tif ( asDraftInput.checked ) {\n\t\t\tdata.draft = true\n\t\t}\n\n\t\tjQuery.ajax( {\n\t\t\turl: dt.ajaxurl,\n\t\t\tmethod: 'post',\n\t\t\tdata: data\n\t\t} ).done( ( response ) => {\n\t\t\tsetTimeout( () => {\n\t\t\t\tactionWrapper.classList.remove( 'loading' )\n\n\t\t\t\tif ( ! response.data || ! response.data.results ) {\n\t\t\t\t\tdoError()\n\t\t\t\t\treturn\n\t\t\t\t}\n\n\t\t\t\tdoSuccess( response.data.results )\n\t\t\t}, 500 )\n\t\t} ).error( () => {\n\t\t\tsetTimeout( () => {\n\t\t\t\tactionWrapper.classList.remove( 'loading' )\n\n\t\t\t\tdoError()\n\t\t\t}, 500 )\n\t\t} )\n\t} )\n\n\t/**\n\t * Add a connection to selected connections for ajax and to the UI list.\n\t */\n\tjQuery( distributorPushWrapper ).on( 'click', '.add-connection', ( event ) => {\n\t\tif ( event.target.nodeName === 'A' ) {\n\t\t\treturn\n\t\t}\n\n\t\tevent.preventDefault()\n\n\t\tif ( event.currentTarget.classList.contains( 'syndicated' ) ) {\n\t\t\treturn\n\t\t}\n\n\t\tif ( event.currentTarget.classList.contains( 'added' ) ) {\n\n\t\t\tconst type = event.currentTarget.getAttribute( 'data-connection-type' )\n\t\t\tconst id   = event.currentTarget.getAttribute( 'data-connection-id' )\n\n\t\t\tconst deleteNode = connectionsSelectedList.querySelector( '[data-connection-id=\"' + id + '\"][data-connection-type=\"' + type + '\"]' )\n\n\t\t\tdeleteNode.parentNode.removeChild( deleteNode )\n\n\t\t\tdelete selectedConnections[type + id]\n\n\t\t\tif ( ! Object.keys( selectedConnections ).length ) {\n\t\t\t\tconnectionsSelected.classList.add( 'empty' )\n\t\t\t}\n\n\t\t\tshowConnections()\n\t\t} else {\n\n\t\t\tconst type = event.currentTarget.getAttribute( 'data-connection-type' )\n\t\t\tconst id   = event.currentTarget.getAttribute( 'data-connection-id' )\n\n\t\t\tselectedConnections[type + id] = dtConnections[type + id]\n\n\t\t\tconnectionsSelected.classList.remove( 'empty' )\n\n\t\t\tconst element       = event.currentTarget.cloneNode()\n\t\t\telement.innerText = event.currentTarget.innerText\n\n\t\t\tconst removeLink = document.createElement( 'span' )\n\t\t\tremoveLink.classList.add( 'remove-connection' )\n\n\t\t\telement.appendChild( removeLink )\n\t\t\telement.classList = 'added-connection'\n\n\t\t\tconnectionsSelectedList.appendChild( element )\n\n\t\t\tshowConnections()\n\t\t}\n\t} )\n\n\t/**\n\t * Remove a connection from selected connections and the UI list\n\t */\n\tjQuery( distributorPushWrapper ).on( 'click', '.remove-connection', ( event ) => {\n\t\tevent.currentTarget.parentNode.parentNode.removeChild( event.currentTarget.parentNode )\n\t\tconst type = event.currentTarget.parentNode.getAttribute( 'data-connection-type' )\n\t\tconst id   = event.currentTarget.parentNode.getAttribute( 'data-connection-id' )\n\n\t\tdelete selectedConnections[type + id]\n\n\t\tif ( ! Object.keys( selectedConnections ).length ) {\n\t\t\tconnectionsSelected.classList.add( 'empty' )\n\t\t}\n\n\t\tshowConnections()\n\t} )\n\n\t/**\n\t * List for connection filtering\n\t */\n\tjQuery( connectionsSearchInput ).on( 'keyup change', _.debounce( ( event ) => {\n\t\tif ( event.currentTarget.value === '' ) {\n\t\t\tshowConnections( dtConnections )\n\t\t}\n\n\t\tsearchString = event.currentTarget.value.replace( /https?:\\/\\//i, '' ).replace( /www/i, '' ).replace( /[^0-9a-zA-Z ]+/, '' )\n\n\t\tshowConnections()\n\t}, 300 ) )\n} )\n\n\n\n// WEBPACK FOOTER //\n// ./assets/js/push.js"],"sourceRoot":""}